<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Login - Malla AP</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0e8ff;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 20px;
      color: #4a3a87;
    }
    h1 {
      margin-bottom: 25px;
    }
    input {
      display: block;
      margin: 10px 0;
      padding: 10px;
      width: 280px;
      border-radius: 8px;
      border: 1px solid #b3a3d1;
      font-size: 1rem;
    }
    button {
      margin-top: 15px;
      padding: 12px 28px;
      border: none;
      background: #9e86d4;
      color: white;
      font-weight: 700;
      border-radius: 10px;
      cursor: pointer;
      width: 300px;
      font-size: 1.1rem;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background: #7a5dc7;
    }
    #msg {
      margin-top: 15px;
      min-height: 20px;
    }
  </style>
</head>
<body>
  <h1>Iniciar Sesión o Crear Cuenta</h1>
  <input id="email" type="email" placeholder="Correo electrónico" />
  <input id="password" type="password" placeholder="Contraseña" />
  <button id="btnLogin">Iniciar Sesión</button>
  <button id="btnRegister">Crear Cuenta</button>
  <div id="msg"></div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAxzAJVTV6ioXf0wnyAx2s1-k9-I83xjB0",
      authDomain: "malla-interactiva-ap.firebaseapp.com",
      projectId: "malla-interactiva-ap",
      storageBucket: "malla-interactiva-ap.appspot.com",
      messagingSenderId: "982790383608",
      appId: "1:982790383608:web:0c0100d098ba1713df580d",
      measurementId: "G-D8F2168ZB3"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    const emailInput = document.getElementById("email");
    const passInput = document.getElementById("password");
    const btnLogin = document.getElementById("btnLogin");
    const btnRegister = document.getElementById("btnRegister");
    const msgDiv = document.getElementById("msg");

    btnLogin.addEventListener("click", () => {
      const email = emailInput.value;
      const password = passInput.value;
      msgDiv.textContent = "Iniciando sesión...";
      msgDiv.style.color = "black";
      auth.signInWithEmailAndPassword(email, password)
        .then(userCredential => {
          msgDiv.textContent = "¡Sesión iniciada! Redirigiendo...";
          window.location.href = "malla.html";
        })
        .catch(error => {
          msgDiv.textContent = "Error: " + error.message;
          msgDiv.style.color = "red";
        });
    });

    btnRegister.addEventListener("click", () => {
      const email = emailInput.value;
      const password = passInput.value;
      if(password.length < 6){
        msgDiv.textContent = "La contraseña debe tener al menos 6 caracteres.";
        msgDiv.style.color = "red";
        return;
      }
      msgDiv.textContent = "Creando cuenta...";
      msgDiv.style.color = "black";
      auth.createUserWithEmailAndPassword(email, password)
        .then(userCredential => {
          msgDiv.textContent = "Cuenta creada! Redirigiendo...";
          window.location.href = "malla.html";
        })
        .catch(error => {
          msgDiv.textContent = "Error: " + error.message;
          msgDiv.style.color = "red";
        });
    });

    auth.onAuthStateChanged(user => {
      if(user){
        window.location.href = "malla.html";
      }
    });
  </script>
</body>
</html>
